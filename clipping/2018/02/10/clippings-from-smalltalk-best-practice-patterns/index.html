<!DOCTYPE html>
<html lang="en-us">
<head>
  <title>Clippings from Smalltalk Best Practice Patterns - dsdshome</title>
  <meta charset="utf-8" />
  <meta name="author" content="Yiming Chen" />
  <meta name="keywords" content="Smalltalk, Patterns, Object-Oriented" />

  <link rel="alternate" title="RSS Feed" href="/rss.xml" type="application/rss+xml">
  <link rel="stylesheet" href="/media/css/main.css" type="text/css">
  <link rel="stylesheet" href="/media/css/posts.css" type="text/css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
</head>

  <body class="container">
<header id="header">
    <body>
        <nav class="navbar navbar-default navbar-fixed-top" style="opacity: .9" role="navigation">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/">dsdshome</a>
                </div>
                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="/blog/">Blog</a></li>
                        <li><a href="/clipping/">Clipping</a></li>
                        <li><a href="/tags/">Tags</a></li>
                        <li><a href="/about/">About</a></li>
                        <li><a href="https://github.com/dsdshcym">GitHub</a></li>
                        <li><a href="/rss.xml">RSS</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </body>
</header>

<section id="content" role="main">
    <div id="outline-container-sec-" class="row" style="padding-top: 70px">
        <div class="col-md-2"></div>
            <h1>Clippings from Smalltalk Best Practice Patterns</h1>
            <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgc92313e">Preface</a></li>
<li><a href="#orgf153e72">Introduction</a></li>
<li><a href="#orgc2b4edf">Patterns</a></li>
<li><a href="#orga6c5ed0">Behavior</a>
<ul>
<li><a href="#orga50cb6a">Methods</a>
<ul>
<li><a href="#org2edba8a">Composed Method</a></li>
<li><a href="#orgd7ac70d">Constructor Method</a></li>
<li><a href="#orgdf09451">Constructor Parameter Method</a></li>
<li><a href="#orgbaa2800">Shortcut Constructor Method</a></li>
<li><a href="#org51d2a48">Conversion</a></li>
<li><a href="#org01909d1">Converter Method</a></li>
<li><a href="#org525c1fd">Converter Constructor Method</a></li>
<li><a href="#org33da141">Query Method</a></li>
<li><a href="#org9f5c850">Comparing Method</a></li>
<li><a href="#org2200c13">Reversing Method</a></li>
<li><a href="#org4f54642">Method Object</a></li>
<li><a href="#org664fcb2">Execute Around Method</a></li>
<li><a href="#orgdefb0c3">Debug Printing Method</a></li>
<li><a href="#orgf36127a">Method Comment</a></li>
</ul>
</li>
<li><a href="#orge3b10b3">Messages</a>
<ul>
<li><a href="#org7dcbf9b">Message</a></li>
<li><a href="#org682a368">Choosing Message</a></li>
<li><a href="#orga200b42">Decomposing Message</a></li>
<li><a href="#orge54b75c">Intention Revealing Message</a></li>
<li><a href="#orgde5f841">Intention Revealing Selector</a></li>
<li><a href="#orgd358ea4">Dispatched Interpretation</a></li>
<li><a href="#org78052e7">Double Dispatch</a></li>
<li><a href="#orgfb1d5f8">Mediating Protocol</a></li>
<li><a href="#org7a81326">Super</a></li>
<li><a href="#org17c5448">Extending Super</a></li>
<li><a href="#org1ccb54f">Modifying Super</a></li>
<li><a href="#org3c4bbc9">Delegation</a></li>
<li><a href="#org23a9feb">Simple Delegation</a></li>
<li><a href="#orgc537878">Self Delegation</a></li>
<li><a href="#orgd26c396">Pluggable Behavior</a></li>
<li><a href="#org216dcb7">Pluggable Selector</a></li>
<li><a href="#orga840f39">Pluggable Block</a></li>
<li><a href="#orgdaa75b0">Collecting Parameter</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org68965a5">State</a>
<ul>
<li><a href="#orgaa4b8df">Instance Variables</a>
<ul>
<li><a href="#org75fb536">Common State</a></li>
<li><a href="#org93b5103">Variable State</a></li>
<li><a href="#org768949b">Explicit Initialization</a></li>
<li><a href="#orgff4fad3">Lazy Initialization</a></li>
<li><a href="#org15b1a4b">Default Value Method</a></li>
<li><a href="#org38b51f4">Constant Method</a></li>
<li><a href="#org63973c3">Direct Variable Access</a></li>
<li><a href="#org8205750">Indirect Variable Access</a></li>
<li><a href="#orgc9da2f1">Getting Method</a></li>
<li><a href="#org1ef9f13">Setting Method</a></li>
<li><a href="#orgaedf7d3">Collection Accessor Method</a></li>
<li><a href="#orgc7bc828">Enumeration Method</a></li>
<li><a href="#orgeb94e6d">Boolean Property Setting Method</a></li>
<li><a href="#org91bebd2">Role Suggesting Instance Variable Name</a></li>
</ul>
</li>
<li><a href="#org1227ae6">Temporary Variable</a>
<ul>
<li><a href="#org25b0000">Temporary Variable</a></li>
<li><a href="#orgcbc2477">Collecting Temporary Variable</a></li>
<li><a href="#org3c3c008">Caching Temporary Variable</a></li>
<li><a href="#org0169d89">Explaining Temporary Variable</a></li>
<li><a href="#org3706763">Reusing Temporary Variable</a></li>
<li><a href="#org06ec142">Role Suggesting Temporary Variable Name</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org55d528f">Collections</a>
<ul>
<li><a href="#orgba57630">Classes</a>
<ul>
<li><a href="#orga1d5fa0">Collections and Stream classes equivalences between Smalltalk, Perl, Python and Ruby - Stack Overflow</a></li>
<li><a href="#orga833a4d">Collection</a></li>
<li><a href="#org43ce6b1">OrderedCollection</a></li>
<li><a href="#org93ba515">RunArray</a></li>
<li><a href="#org7df3d81">Set</a></li>
<li><a href="#org69ecd9e">Equality Method</a></li>
<li><a href="#orgd323561">Hashing Method</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgce9ccc6">Classes</a>
<ul>
<li><a href="#org1ef614d">Simple Superclass Name</a></li>
<li><a href="#orgeb4ae56">Qualified Subclass Name</a></li>
</ul>
</li>
<li><a href="#org89c134d">Formatting</a></li>
<li><a href="#org8ae1b80">Development Example</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgc92313e" class="outline-2">
<h2 id="orgc92313e">Preface</h2>
<div class="outline-text-2" id="text-orgc92313e">
<ul class="org-ul">
<li>What's it all about?
<ul class="org-ul">
<li>Simple things experienced, successful Smalltalkers do that
beginners don't</li>
<li>Style guide</li>
<li>Daily tactics of programming
<ul class="org-ul">
<li>Naming</li>
<li>Splitting methods</li>
<li>Clear code</li>
</ul></li>
<li>92 patterns</li>
</ul></li>
<li>Each pattern presents:
<ol class="org-ol">
<li>A recurring daily programming problem</li>
<li>the trade-offs that affect solutions to the problem</li>
<li>a concrete recipe to create a solution for the problem</li>
</ol></li>
<li>Why should you read it?
<ul class="org-ul">
<li>Learning</li>
<li>Programming</li>
<li>Teaching</li>
<li>Managing</li>
</ul></li>
<li>What isn't it about?
<ul class="org-ul">
<li>Methodology</li>
<li>Philosophy</li>
<li>Design</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgf153e72" class="outline-2">
<h2 id="orgf153e72">Introduction</h2>
<div class="outline-text-2" id="text-orgf153e72">
<ul class="org-ul">
<li>Smalltalk Best Practice Patterns
<dl class="org-dl">
<dt>Smalltalk</dt><dd>The language</dd>
<dt>Best Practice</dt><dd>A Legal term.
Best practice is the set of procedures and skills
that profes- sionals recognize and use.</dd>
<dt>Patterns</dt><dd>A decision an expert makes over and over</dd>
</dl></li>
<li>Coding
<ul class="org-ul">
<li>Development consists of two processes that feed each other
<ol class="org-ol">
<li>Figure out what you want the computer to do</li>
<li>Instruct the computer to do it (which inevitably changes what
you want the computer do)</li>
</ol></li>
<li>Coding is
<ol class="org-ol">
<li>where your fuzzy, comfortable ideas awaken in the harsh dawn of
reality</li>
<li>where you learn what your computer can do (if you stop coding,
you stop learning)</li>
<li>where our design guesses are tested</li>
</ol></li>
<li>Talking Programs
<ul class="org-ul">
<li>Many of the patterns tell you what to do when your program talks
to you</li>
<li>Simply follow where the code leads</li>
<li>Some of the biggest improvements
<ul class="org-ul">
<li>Duplicate code</li>
<li>Conditional logic</li>
<li>Complex methods</li>
<li>Structural code (where one object treats another as a data
structure)</li>
</ul></li>
</ul></li>
</ul></li>
<li>Good Software
<ul class="org-ul">
<li>The life of most programs
<ol class="org-ol">
<li>It is developed in a hurry by a team of developers. Time to
market is critical for reducing the business risk of a new
product. The prod- uct itself is technically challenging to
build but doesn’t break new ground in lots of areas at once.</li>
<li>The product lives for several years, during which time its
capabili- ties are refined and extended, often by developers
who weren’t part of the original team.</li>
<li>Bits and pieces of the product are cannibalized for new
projects, again, not by the original developers.</li>
</ol></li>
<li>A good program balances the needs of these activities</li>
<li>Most of the patterns are designed to preserve a balance between
short-term and long-term needs</li>
<li><b>The bottlenecks throughout development come from limitations in
human communication</b>
<ul class="org-ul">
<li>When you program, you have to <b>think about how someone will read
your code</b>, not just how a computer will interpret it</li>
</ul></li>
<li>Criteria considered in these patterns
<ul class="org-ul">
<li>Productivity</li>
<li>Life-cycle cost</li>
<li>Time to Market</li>
<li>Risk</li>
</ul></li>
</ul></li>
<li>Style
<ul class="org-ul">
<li>Good predictors of whether a project is in good shape
<ul class="org-ul">
<li>Once and only once (DRY)</li>
<li>Lots of little pieces</li>
<li>Replacing objects</li>
<li>Moving objects
<ul class="org-ul">
<li>Objects that can be easily moved to new contexts</li>
<li>Ship a couple of systems first</li>
<li>Then generalize little pieces easily</li>
</ul></li>
<li>Rates of change
<ul class="org-ul">
<li>Same level of abstraction</li>
<li>Don't put two rates of change together</li>
<li>avoid this problem by making lots of little pieces</li>
</ul></li>
</ul></li>
</ul></li>
<li>What's Missing?
<ul class="org-ul">
<li>Exception handling</li>
<li>Copying</li>
<li>Become</li>
<li>Performance</li>
</ul></li>
<li>Book Organization
<dl class="org-dl">
<dt>Patterns</dt><dd>The philosophy behind patterns.</dd>
<dt>Behavior</dt><dd>Patterns for methods and messages. The problems you
can solve by creating a new method. You will also find
method pat- terns scattered throughout the remainder
of the patterns, if a par- ticular kind of method
(like accessors) is tied to another pattern. The quick
reference guide gathers all the method patterns
together for easy reference.</dd>
<dt>State</dt><dd>Patterns for using instance and temporary variables. You
will find a discussion of the pros and cons of using
accessor methods and direct variable access.</dd>
<dt>Collections</dt><dd>The major collection classes and messages in the
form of patterns. You will also find common tricks
using collections.</dd>
<dt>Classes</dt><dd>A brief introduction to how to use classes, since most
of the topics regarding class creation are outside the
scope of this book.</dd>
<dt>Formatting</dt><dd>My rules of code formatting, cast as patterns.</dd>
<dt>Development Example</dt><dd>An example of developing objects with
explicit reference to the patterns, as they apply.</dd>
</dl></li>
<li>Adoption</li>
<li>Learning a Pattern
<ol class="org-ol">
<li>Context</li>
<li>Example</li>
<li>Problem/Solution</li>
<li>Look for Examples</li>
<li>Try to write an Example</li>
</ol></li>
</ul>
</div>
</div>
<div id="outline-container-orgc2b4edf" class="outline-2">
<h2 id="orgc2b4edf">Patterns</h2>
<div class="outline-text-2" id="text-orgc2b4edf">
<ul class="org-ul">
<li>Why Patterns Work
<ul class="org-ul">
<li>A Big Assumption: <b>There are only so many things objects can do</b>
<ul class="org-ul">
<li>The same structures of objects keep appearing over and over,
<b>regardless of the application</b></li>
</ul></li>
<li><b>The problems in the construction of objects are universal</b>
<ol class="org-ol">
<li>name classes</li>
<li>relate classes via inheritance and delegation</li>
<li>relate methods in the same class and different classes</li>
<li>name variables</li>
</ol></li>
<li>Patterns record these problems and how to approach solving them</li>
<li>How to improve communication?
<ol class="org-ol">
<li>increase the bandwidth
<ul class="org-ul">
<li>so you can communicate more bits</li>
<li>impractical (one developer can only be sliced into so many
pieces)</li>
</ul></li>
<li>increase the context shared between sender and receiver
<ul class="org-ul">
<li>so the same number of bits mean more</li>
</ul></li>
</ol></li>
<li>When you want to optimize any process, the first strategy to
employ is to find how the common case is simpler than the general
case
<dl class="org-dl">
<dt>general case</dt><dd>Programming language. We don't go all the way
back to the language to solve problems. We look
at what we did last week/month/year</dd>
<dt>common case</dt><dd>Patterns. These "catch phrases" speed up our
development process</dd>
</dl></li>
<li>Oral tradition has 2 problems
<ol class="org-ol">
<li>not newbie friendly</li>
<li>doesn't scale</li>
</ol></li>
<li>Patterns are a literary form for capturing and transmitting common
practice
<ul class="org-ul">
<li>Each pattern records
<ol class="org-ol">
<li>A recurring problem</li>
<li>How to construct a solution for the problem</li>
<li>Why the solution is appropriate</li>
</ol></li>
</ul></li>
<li>Patterns can be articulated at all levels of development
<ul class="org-ul">
<li>How to schedule and sequence system development</li>
<li>How to create an application with a particular class library</li>
<li>How to design new objects</li>
<li>How to format source code so that</li>
</ul></li>
</ul></li>
<li>Role of Patterns
<dl class="org-dl">
<dt>Reading</dt><dd>Help you read and understand more quickly and thoroughly</dd>
<dt>Development</dt><dd>As a guide for how to solve the same problems</dd>
<dt>Review</dt><dd>Group reviews will go much more smoothly if everyone
knows and uses the patterns</dd>
<dt>Documentation</dt><dd>Describe the system much more imply than if you
use ordinary prose</dd>
<dt>Clean up</dt><dd><ul class="org-ul">
<li>Start with formatting patterns</li>
<li>Simplify methods with Composed Method and Explaining Temporary
Variable</li>
<li>Check duplicated code, the sign of an opportunity for
improvement</li>
</ul></dd>
</dl></li>
<li>Format
<ul class="org-ul">
<li>Each pattern records an atomic decision</li>
<li><p>
Each pattern has the same format
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Element</th>
<th scope="col" class="org-left">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Title</td>
<td class="org-left">Names the thing created as a result of executing the pattern. Intended to be used conversationally to refer to the pattern - “Oh, I think you need a State Object here.”</td>
</tr>

<tr>
<td class="org-left">Preceding patterns</td>
<td class="org-left">Briefly describes which pattern precedes this one and why. Some patterns are nonsense taken out of order. Other orderings are the result of experience about which problems are most important and which can be safely deferred. Appears in Avant Garde Bold Italic.</td>
</tr>

<tr>
<td class="org-left">Problem</td>
<td class="org-left">Stated as a question. Reading the problem will quickly tell you whether you are interested in the rest of the pattern. Appears in Avant Garde.</td>
</tr>

<tr>
<td class="org-left">Forces</td>
<td class="org-left">Describes the constraints on any solution to the problem and argues for the solution called for in this pattern. After reading the forces section, you should either be convinced that the solution is valid for your situation or you should know why the solution isn’t valid. Sometimes it takes the form of a description of alternatives and why they don’t work, sometimes it’s just a discussion of the influences on the design decision.</td>
</tr>

<tr>
<td class="org-left">Solution</td>
<td class="org-left">Gives you an unambiguous, concrete recipe for creating the thing named by the title of the pattern. These will typically be development environment actions—subclass this, name this variable thus-and-so, etc. Appears in Avant Garde Italic.</td>
</tr>

<tr>
<td class="org-left">Discussion</td>
<td class="org-left">Tells you how to make practical use of the pattern. May contain an example of use or give you issues to watch out for. Appears in Avant Garde.</td>
</tr>

<tr>
<td class="org-left">Following patterns</td>
<td class="org-left">Tells you what patterns should be considered next. Appears in Avant Garde Bold Italic.</td>
</tr>
</tbody>
</table></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orga6c5ed0" class="outline-2">
<h2 id="orga6c5ed0">Behavior</h2>
<div class="outline-text-2" id="text-orga6c5ed0">
<ul class="org-ul">
<li>Preface
<ul class="org-ul">
<li><b>How to specify behavior so that your intent is clearly communicated
to your reader</b>
<ul class="org-ul">
<li>The more centralized the flow of control, the easier it is to
follow
<ul class="org-ul">
<li>in the sense that you don't have to go bouncing around all over
the place to understand how work is accomplished</li>
</ul></li>
<li>Centralizing control kills flexibility
<ul class="org-ul">
<li>You want to have lots of objects involved so you have many
opportunities to replace objects to change the system, and so
you can completely factor code</li>
</ul></li>
</ul></li>
<li>Behavior v.s. State
<ul class="org-ul">
<li>Behavior is the dynamic, active, computational part of the model</li>
<li>State is what is left after behavior is done</li>
</ul></li>
<li>Behavior is more important to get right
<ul class="org-ul">
<li>In Procedural languages, you want to get the representation
right as quickly as possible
because every change to the representation bred changes in many
different computations</li>
<li>Objects (done right) change all that
<ul class="org-ul">
<li>Because objects can hide their representation behind a wall of
messages</li>
<li>You are free to change representation and only affect one
object</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="outline-container-orga50cb6a" class="outline-3">
<h3 id="orga50cb6a">Methods</h3>
<div class="outline-text-3" id="text-orga50cb6a">
<ul class="org-ul">
<li>Methods are important
<ul class="org-ul">
<li>They must do the work they are supposed to do</li>
<li>They must communicate the intent of the work to be done</li>
</ul></li>
<li>Methods decompose the function of your program into easily
digestible chunks</li>
<li>Methods are the granularity of overriding</li>
<li>Methods don't come for free
<ol class="org-ol">
<li>writing, naming, remembering, rediscovering, and communicating
them all take time
<ul class="org-ul">
<li><b>If there is no benefit to be gained, bigger methods would be
better than small because of the reduced management overhead</b></li>
</ul></li>
<li>methods cost in performance as well
<ul class="org-ul">
<li>Using methods as a layer to make your performance measurement
and tuning more effective</li>
<li>better factored code, with lots of small methods, both
<dl class="org-dl">
<dt>allows more accurate and concise performance measurement</dt><dd>because there aren't little snippets of code duplicated
all over</dd>
<dt>provides leverage for tuning</dt><dd>through techniques like Caching Instance Variable</dd>
</dl></li>
</ul></li>
</ol></li>
<li>The goal of breaking your program into methods is to
<ol class="org-ol">
<li>communicate your intent clearly with your reader</li>
<li>provide for future flexibility</li>
<li>set yourself up for effective performance tuning where necessary</li>
</ol></li>
</ul>
</div>
<div id="outline-container-org2edba8a" class="outline-4">
<h4 id="org2edba8a">Composed Method</h4>
<div class="outline-text-4" id="text-org2edba8a">
<p>
<b>How do you divide a program into methods?</b>
</p>
<blockquote>
<p>
Divide your program into methods that perform one identifiable task.
Keep all of the operations in a method at the same level of
abstraction. This will naturally result in programs with many small
methods, each a few lines long
</p>
</blockquote>

<ul class="org-ul">
<li>Well chosen message names let you correctly assume the meaning of
invoked code</li>
<li>The opportunity to communicate through intention revealing message
names is the most compelling reason to keep methods small
<ul class="org-ul">
<li>People can read your programs much more quickly and accurately
if they can understand them in detail, then <b>chunk those details
into higher level structures</b></li>
<li>Deviding a program into methods gives you an opportunity to
guide that chunking</li>
</ul></li>
<li>Small methods ease maintenance</li>
<li>Small methods make inheritance work smoothly</li>
<li>How?
<ul class="org-ul">
<li>Top-down
<ul class="org-ul">
<li>invoke several smaller methods, (without having an
implementation yet)</li>
<li>A thought tool for breaking your development into pieces</li>
</ul></li>
<li>Bottom-up
<ul class="org-ul">
<li>Extract Method</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgd7ac70d" class="outline-4">
<h4 id="orgd7ac70d">Constructor Method</h4>
<div class="outline-text-4" id="text-orgd7ac70d">
<p>
<b>How do you represent instance creation?</b>
</p>
<blockquote>
<p>
Provide methods that create well-formed instances. Pass all required
parameters to them
</p>
</blockquote>

<ul class="org-ul">
<li>How?
<ol class="org-ol">
<li>Keep parameters for a Constructor Method simple</li>
<li>Make sure there is a method to represent each valid way to create
an instance
<ul class="org-ul">
<li>Most classes only have a single way to create an instance</li>
<li>For the rare exceptions, use Constructor Methods for the common
cases and provide Accessor Methods for the remainder</li>
</ul></li>
</ol></li>
<li>Describe parameters' roles, instead of types</li>
</ul>
</div>
</div>
<div id="outline-container-orgdf09451" class="outline-4">
<h4 id="orgdf09451">Constructor Parameter Method</h4>
<div class="outline-text-4" id="text-orgdf09451">
<p>
<b>How do you set instance variables from the parameters to a
 Constructor Method?</b>
</p>
<blockquote>
<p>
Code a single private method that sets all the variables
Preface its name with <code>set</code>, then the names of the variables
</p>
</blockquote>
<ul class="org-ul">
<li>Separate two circumstances
<ol class="org-ol">
<li>State initialization during instance creation</li>
<li>State change during computation</li>
</ol></li>
<li>Explicit Initialization</li>
</ul>
</div>
</div>
<div id="outline-container-orgbaa2800" class="outline-4">
<h4 id="orgbaa2800">Shortcut Constructor Method</h4>
<div class="outline-text-4" id="text-orgbaa2800">
<p>
<b>What is the external interface for creating a new object when a
 Constructor Method is too wordy?</b>
</p>
<blockquote>
<p>
Represent object creation as a message to one of the arguments to the
Constructor Method.
<b>Add no more than three of these Shortcut Constructor Methods per
system you develop.</b>
</p>
</blockquote>
<ul class="org-ul">
<li>Two Problems with an explicit class-based interface for
object-creation
<ol class="org-ol">
<li>wordy</li>
<li>can be misleading (?)</li>
</ol></li>
<li>The problems with representing object creation as a message to one
of the arguments
<ol class="org-ol">
<li>It puts a burden on the programmer to remember the message</li>
<li>It cannot be easily looked up by looking at the instance creation
methods of the class</li>
</ol></li>
</ul>
</div>
</div>
<div id="outline-container-org51d2a48" class="outline-4">
<h4 id="org51d2a48">Conversion</h4>
<div class="outline-text-4" id="text-org51d2a48">
<p>
<b>How do you convert information from one object's format to
 another's?</b>
</p>
<blockquote>
<p>
Convert from one object to another rather than overwhelm any one
object's protocol
</p>
</blockquote>
<ul class="org-ul">
<li>Converter Method</li>
<li>Converter Constructor Method</li>
</ul>
</div>
</div>
<div id="outline-container-org01909d1" class="outline-4">
<h4 id="org01909d1">Converter Method</h4>
<div class="outline-text-4" id="text-org01909d1">
<p>
<b>How do you represent simple conversion of an object to another object
 with the same protocol but different format?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Provide a method in the object to be converted that converts to the
new object</li>
<li>Name the method by prepending <code>as</code> to the class of the object
returned</li>
</ol>
</blockquote>
<ul class="org-ul">
<li>Problems with <i>representing conversion as methods in the object to be
converted</i>
<ol class="org-ol">
<li>There is no limit to the number of methods that can be added</li>
<li>It ties the receiver with a class of which it would otherwise be
obvious</li>
</ol></li>
<li><b>Only</b> representing conversions with a message to the object to be
converted when
<ol class="org-ol">
<li>The source and destination of conversion share the same protocol</li>
<li>There is only one reasonable way to implement the conversion</li>
</ol></li>
</ul>
</div>
</div>
<div id="outline-container-org525c1fd" class="outline-4">
<h4 id="org525c1fd">Converter Constructor Method</h4>
<div class="outline-text-4" id="text-org525c1fd">
<p>
<b>How do you represent the conversion of an object to another with
 different protocol</b>
</p>
<blockquote>
<p>
Make a Constructor Method that takes the object to be converted as an
argument
</p>
</blockquote>
<div class="org-src-container">
<pre class="src src-ruby">Date.from_string
</pre>
</div>
</div>
</div>
<div id="outline-container-org33da141" class="outline-4">
<h4 id="org33da141">Query Method</h4>
<div class="outline-text-4" id="text-org33da141">
<p>
<b>How do you represent testing a property of an object?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Provide a method that returns a Boolean.</li>
<li>Name it by prefacing the name with a form of "be" (is, was, will,
etc.) (Or postfix the name with <code>?</code>)</li>
</ol>
</blockquote>
<ul class="org-ul">
<li>Two decisions here:
<ol class="org-ol">
<li>Deciding what to return from a method that tests a property
<ul class="org-ul">
<li>It's far easier to maintain a relationship based solely on
messages. (Boolean)</li>
</ul></li>
<li>What you should name the method
<ul class="org-ul">
<li><code>Switch#on?</code></li>
</ul></li>
</ol></li>
<li>Provide an inverse method if you use it a lot</li>
</ul>
</div>
</div>
<div id="outline-container-org9f5c850" class="outline-4">
<h4 id="org9f5c850">Comparing Method</h4>
<div class="outline-text-4" id="text-org9f5c850">
<p>
<b>How do you order objects with respect to each other?</b>
</p>
<blockquote>
<p>
Implement <code>&lt;=</code> to return true if the receiver should be ordered before
the argument
</p>
</blockquote>
<ul class="org-ul">
<li>Ordering is often done in terms of Simple Delegation to the ordering
of other objects</li>
<li>Use a Temporarily Sorted Collection for multiple orderings</li>
</ul>
</div>
</div>
<div id="outline-container-org2200c13" class="outline-4">
<h4 id="org2200c13">Reversing Method</h4>
<div class="outline-text-4" id="text-org2200c13">
<p>
<b>How do you code a smooth flow of messages?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Code a method on the parameter.</li>
<li>Derive its name from the original message</li>
<li>Take the original receiver as a parameter to the new method</li>
<li>Implement the method by sending the original message to the
original receiver</li>
</ol>
</blockquote>
<ul class="org-ul">
<li><b>Good code has a rhythm that makes it easy to understand</b></li>
<li>Make sure that all messages go through a single object, in a
Composed Method</li>
</ul>
<div class="org-src-container">
<pre class="src src-ruby">class Point
  def print_on(stream)
    x.print_on(stream)
    stream.next_put_all('@')
    y.print_on(stream)
  end
end
</pre>
</div>
<div class="org-src-container">
<pre class="src src-ruby">class Stream
  def print(object)
    object.print_on(self)
  end
end

class Point
  def print_on(stream)
    stream.print(x)
    stream.next_put_all('@')
    stream.print(y)
  end
end
</pre>
</div>
</div>
</div>
<div id="outline-container-org4f54642" class="outline-4">
<h4 id="org4f54642">Method Object</h4>
<div class="outline-text-4" id="text-org4f54642">
<p>
<b>How do you code a method where many lines of code share many
 arguments and temporary variables</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Create a class named after the method.</li>
<li>Give it an instance variable for the receiver of the original
method, each argument, and each temporary variable.</li>
<li>Give it a Constructor Method that takes the original receiver and
the method arguments.</li>
<li>Give it one instance method, #compute, implemented by copying the
body of the original method.</li>
<li>Replace the method with one that creates an instance of the new
class and sends it #compute.</li>
</ol>
</blockquote>
</div>
</div>
<div id="outline-container-org664fcb2" class="outline-4">
<h4 id="org664fcb2">Execute Around Method</h4>
<div class="outline-text-4" id="text-org664fcb2">
<p>
<b>How do you represent pairs of actions that have to be taken
 together?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Code a method that takes a Block as an argument.</li>
<li>Name the method by appending “During: aBlock” to the name of the
first method that needs to be invoked.</li>
<li>In the body of the Execute Around Method, invoke the first method,
evaluate the block, then invoke the second method.</li>
</ol>
</blockquote>
</div>
</div>
<div id="outline-container-orgdefb0c3" class="outline-4">
<h4 id="orgdefb0c3">Debug Printing Method</h4>
<div class="outline-text-4" id="text-orgdefb0c3">
<p>
<b>How do you code the default printing method</b>
</p>
<blockquote>
<p>
Override printOn: (#to_s) to provide information about an object's
structure to the programmer
</p>
</blockquote>
<ul class="org-ul">
<li>Separate string interfaces for clients and debugging</li>
</ul>
</div>
</div>
<div id="outline-container-orgf36127a" class="outline-4">
<h4 id="orgf36127a">Method Comment</h4>
<div class="outline-text-4" id="text-orgf36127a">
<p>
<b>How do you comment methods?</b>
</p>
<blockquote>
<p>
Communicate important information that is not obvious from the code in
a comment at the beginning of the method
</p>
<ol class="org-ol">
<li>Method dependencies</li>
<li>TODO</li>
<li>Reasons for change, particularly base class (Git Message)</li>
</ol>
</blockquote>
<ul class="org-ul">
<li>Intention Revealing Selector communicates what the method does</li>
<li>Type Suggesting Parameter Name says what the arguments are expected
to be</li>
<li>patterns like Query Method suggest return types</li>
<li>Each method only computes a single case</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orge3b10b3" class="outline-3">
<h3 id="orge3b10b3">Messages</h3>
<div class="outline-text-3" id="text-orge3b10b3">
<ul class="org-ul">
<li>Procedural languages explicitly make choices</li>
<li>OO languages use messages to make choices for you</li>
</ul>
</div>
<div id="outline-container-org7dcbf9b" class="outline-4">
<h4 id="org7dcbf9b">Message</h4>
<div class="outline-text-4" id="text-org7dcbf9b">
<p>
<b>How do you invoke computation?</b>
</p>
<blockquote>
<p>
Send a named message and let the receiving object decide what to do
with it
</p>
</blockquote>
<ul class="org-ul">
<li>All procedural control structures, conditionals and loops, are
implemented in terms of messages in Smalltalk</li>
</ul>
</div>
</div>
<div id="outline-container-org682a368" class="outline-4">
<h4 id="org682a368">Choosing Message</h4>
<div class="outline-text-4" id="text-org682a368">
<p>
<b>How do you execute one of several alternatives?</b>
</p>
<blockquote>
<p>
Send a message to one of several different kinds of objects, each of
which executes one alternative
</p>
</blockquote>
<ul class="org-ul">
<li>Messages provide a disciplined way to handle theme-and-variation
programming
<ol class="org-ol">
<li>The variations live in different objects, they have much less
opportunity to interfere with each other than just putting the
variations in different parts of the same routine</li>
<li>The object invoking the variations is also isolated from what
variation is currently active</li>
</ol></li>
</ul>
</div>
</div>
<div id="outline-container-orga200b42" class="outline-4">
<h4 id="orga200b42">Decomposing Message</h4>
<div class="outline-text-4" id="text-orga200b42">
<p>
<b>How do you invoke parts of a computation?</b>
</p>
<blockquote>
<p>
Send several messages to <code>self</code>
</p>
</blockquote>
<ul class="org-ul">
<li>Keep methods fit into a few lines, (less than 10, often 3 or 4)</li>
</ul>
</div>
</div>
<div id="outline-container-orge54b75c" class="outline-4">
<h4 id="orge54b75c">Intention Revealing Message</h4>
<div class="outline-text-4" id="text-orge54b75c">
<p>
<b>How do you communicate your intent when the implementation is
 simple?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Send a message to <code>self</code></li>
<li>Name the message so it communicates <b>what is to be done</b> rather
than how it is to be done</li>
<li>Code a simple method for the message</li>
</ol>
</blockquote>
<ul class="org-ul">
<li>Intention Revealing Messages are the most extreme case of <b>writing
for readers</b> instead of the computer</li>
</ul>
</div>
</div>
<div id="outline-container-orgde5f841" class="outline-4">
<h4 id="orgde5f841">Intention Revealing Selector</h4>
<div class="outline-text-4" id="text-orgde5f841">
<p>
<b>What od you name a method?</b>
</p>
<blockquote>
<p>
Name methods after what they accomplish
</p>
</blockquote>
<ul class="org-ul">
<li>Leave "how" to the various method bodies</li>
<li>A simple exercise that will help you generalize names of messages
with a single implementation
<ol class="org-ol">
<li>Imagine a second, very different implementation</li>
<li>Ask yourself if you'd give that method the same name</li>
<li>If so, you've probably abstracted the name as much as you know
how to at the moment</li>
</ol></li>
</ul>
</div>
</div>
<div id="outline-container-orgd358ea4" class="outline-4">
<h4 id="orgd358ea4">Dispatched Interpretation</h4>
<div class="outline-text-4" id="text-orgd358ea4">
<p>
<b>How can two objects cooperate when one wishes to conceal its
 representation?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Have the client send a message to the encoded object.</li>
<li>Pass a parameter to which the encoded object will send decoded
messages</li>
</ol>
</blockquote>
<ul class="org-ul">
<li>How you distribute responsibility among objects (messages) is the
critical decision, encoding (data structure) is a distant second</li>
<li><p>
example (<code>#each</code>)
</p>
<div class="org-src-container">
<pre class="src src-ruby">array.each do |item|
  item.decode
end
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-org78052e7" class="outline-4">
<h4 id="org78052e7">Double Dispatch</h4>
<div class="outline-text-4" id="text-org78052e7">
<p>
<b>How can you code a computation that has many cases, the cross product
 of two families of classes?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Send a message to the argument.</li>
<li>Append the class name of the receiver to the selector</li>
<li>Pass the receiver as an argument</li>
</ol>
</blockquote>
<ul class="org-ul">
<li>Visitor pattern and double dispatch in ruby - BigBinary Blog</li>
<li>Example
<ol class="org-ol">
<li><p>
binary operator like +
</p>
<div class="org-src-container">
<pre class="src src-ruby">class Integer
  def +(number)
    number.add_integer(self)
  end

  def add_integer(integer)
    self.+(integer)
  end

  def add_float(float)
    self.to_float.add_float(float)
  end
end

class Float
  def +(number)
    number.add_float(self)
  end

  def add_integer(integer)
    self.add_float(integer.to_float)
  end

  def add_float(float)
    self.+(float)
  end
end
</pre>
</div></li>
<li><p>
drag-and-drop operations
</p>
<pre class="example">
You want to execute different code depending on what kind of object is
being dragged over what kind of receiver
</pre></li>
</ol></li>
<li>In the worst cast, Double Dispatch can lead to <code>N * M</code> methods
<dl class="org-dl">
<dt>N</dt><dd>the number of classes of the original receiver</dd>
<dt>M</dt><dd>the number of classes of the original argument</dd>
</dl></li>
</ul>
</div>
</div>
<div id="outline-container-orgfb1d5f8" class="outline-4">
<h4 id="orgfb1d5f8">Mediating Protocol</h4>
<div class="outline-text-4" id="text-orgfb1d5f8">
<p>
<b>How do you code the interaction between two objects that need to
 remain independent?</b>
</p>
<blockquote>
<p>
Refine the protocol between the objects so the words used are
consistent.
</p>
</blockquote>
<ul class="org-ul">
<li>Put all the methods to support a Mediating Protocol in a single
method protocol, so that they are easy to find and duplicate</li>
</ul>
</div>
</div>
<div id="outline-container-org7a81326" class="outline-4">
<h4 id="org7a81326">Super</h4>
<div class="outline-text-4" id="text-org7a81326">
<p>
<b>How can you invoke super-class behavior?</b>
</p>
<blockquote>
<p>
Invoke code in a super-class explicitly by sending a message to
<code>super</code> instead of <code>self</code>
</p>
</blockquote>
<ul class="org-ul">
<li>like calling <code>super</code> in <code>initialize</code></li>
<li>Always check code using <code>super</code> carefully
<ul class="org-ul">
<li>*Change <code>super</code> to <code>self</code> if doing so does not change how the code
executes</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org17c5448" class="outline-4">
<h4 id="org17c5448">Extending Super</h4>
<div class="outline-text-4" id="text-org17c5448">
<p>
<b>How do you add to a super-class' implementation of a method?</b>
</p>
<blockquote>
<p>
Override the method and send a message to <code>super</code> in the overriding
method
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org1ccb54f" class="outline-4">
<h4 id="org1ccb54f">Modifying Super</h4>
<div class="outline-text-4" id="text-org1ccb54f">
<p>
<b>How do you change part of the behavior of a super-class' method
 without modifying it?</b>
</p>
<blockquote>
<p>
Override the method and invoke <code>super</code>, then execute the code to
modify the results
</p>
</blockquote>
<ul class="org-ul">
<li>Use Composed Method to split super method into smaller pieces and
override some of them</li>
<li>Use a Default Value Method to represent the default value</li>
</ul>
</div>
</div>
<div id="outline-container-org3c4bbc9" class="outline-4">
<h4 id="org3c4bbc9">Delegation</h4>
<div class="outline-text-4" id="text-org3c4bbc9">
<p>
<b>How does an object share implementation without inheritance?</b>
</p>
<blockquote>
<p>
Pass part of its work on to another object
</p>
</blockquote>
<ul class="org-ul">
<li>Use Simple Delegation when the delegate need know nothing about the
original object</li>
<li>Use Self Delegation when the identity of the original object or some
of its state is needed by the delegate</li>
</ul>
</div>
</div>
<div id="outline-container-org23a9feb" class="outline-4">
<h4 id="org23a9feb">Simple Delegation</h4>
<div class="outline-text-4" id="text-org23a9feb">
<p>
<b>How do you invoke a disinterested delegate?</b>
</p>
<blockquote>
<p>
Delegate messages unchanged
</p>
</blockquote>
<ol class="org-ol">
<li>Is the identity of the delegating object important?</li>
<li>Is the state of the delegating object important to the delegate?</li>
</ol>
</div>
</div>
<div id="outline-container-orgc537878" class="outline-4">
<h4 id="orgc537878">Self Delegation</h4>
<div class="outline-text-4" id="text-orgc537878">
<p>
<b>How do you implement delegation to an object that needs reference to
 the delegating object?</b>
</p>
<blockquote>
<p>
Pass along the delegating object (<code>self</code>) in an additional parameter
</p>
</blockquote>
<ul class="org-ul">
<li>Use Double Dispatch if the delegate needs different logic depending
on who is delegating</li>
</ul>
</div>
</div>
<div id="outline-container-orgd26c396" class="outline-4">
<h4 id="orgd26c396">Pluggable Behavior</h4>
<div class="outline-text-4" id="text-orgd26c396">
<p>
<b>How do you parameterize the behavior of an object?</b>
</p>
<blockquote>
<p>
Add a variable that will be used to trigger different behavior.
</p>
</blockquote>
<ul class="org-ul">
<li>Benefits and Drawbacks of Classes
<ul class="org-ul">
<li>Benefits
<ul class="org-ul">
<li>Useful to instantiate and/or specialize</li>
</ul></li>
<li>Drawbacks
<ul class="org-ul">
<li>Puts a burden on writer to communicate its purpose and
implementation well</li>
<li>A namespace across many classes is hard to manage</li>
<li><b>Classes are not flexible</b>
<ul class="org-ul">
<li>You cannot change an existing object's class without
completely ruining the ability to understand the code
<b>statically</b></li>
</ul></li>
</ul></li>
</ul></li>
<li>A large family of classes with only a single method each is unlikely
to be valuable</li>
<li>Consider before using Pluggable Behavior
<ul class="org-ul">
<li>How much flexibility do you need?</li>
<li>How many methods will need to vary dynamically?</li>
<li>How hard is it to follow the code?</li>
<li>Will clients need to specify the behavior to be plugged, or can it
be hidden within the plugged object?</li>
</ul></li>
<li><p>
Example
</p>
<pre class="example">
User Interface components that have to display the contents of many
different objets
</pre></li>
</ul>
</div>
</div>
<div id="outline-container-org216dcb7" class="outline-4">
<h4 id="org216dcb7">Pluggable Selector</h4>
<div class="outline-text-4" id="text-org216dcb7">
<p>
<b>How do you code simple instance specific behavior?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Add a variable that contains a selector to be performed.</li>
<li>Append "Message" to the Role Suggesting Instance Variable Name.</li>
<li>Create a Composed Method that simply performs the selector.</li>
</ol>
</blockquote>
</div>
</div>
<div id="outline-container-orga840f39" class="outline-4">
<h4 id="orga840f39">Pluggable Block</h4>
<div class="outline-text-4" id="text-orga840f39">
<p>
<b>How do you code complex Pluggable behavior that is not quite worth
 its own class?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Add an instance variable to store a block.</li>
<li>Append "Block" to the Role Suggesting Instance Variable Name.</li>
<li>Create a Composed Method to evaluate the Block to invoke the
Pluggable Behavior.</li>
</ol>
</blockquote>
<ul class="org-ul">
<li>Enormous Cost
<ol class="org-ol">
<li><p>
You can never statically analyze the code to understand the flow
of control.
</p>

<p>
Only by single stepping through the invocation of the block will
the reader understand what is going on
</p></li>
<li>Blocks are more difficult to persist</li>
</ol></li>
</ul>
</div>
</div>
<div id="outline-container-orgdaa75b0" class="outline-4">
<h4 id="orgdaa75b0">Collecting Parameter</h4>
<div class="outline-text-4" id="text-orgdaa75b0">
<p>
<b>How do you return a collection that is the collaborative result of
 several methods?</b>
</p>
<blockquote>
<p>
Add a parameter that collects their results to all of the submethods.
</p>
</blockquote>
<ul class="org-ul">
<li><p>
married_man_and_unmarried_women
</p>
<div class="org-src-container">
<pre class="src src-ruby">def married_man_and_unmarried_women
  result = []

  people.each do |person|
    result &lt;&lt; person if person.married? &amp;&amp; person.man?
  end

  people.each do |person|
    result &lt;&lt; person if person.unmarried? &amp;&amp; person.woman?
  end

  result
end
</pre>
</div></li>
<li><p>
Composed Method
</p>
<div class="org-src-container">
<pre class="src src-ruby">def married_man_and_unmarried_women
  married_men + unmarried_women
end

def married_men
  result = []

  people.each do |person|
    result &lt;&lt; person if person.married? &amp;&amp; person.man?
  end

  result
end

def unmarried_women
  result = []

  people.each do |person|
    result &lt;&lt; person if person.married? &amp;&amp; person.man?
  end

  result
end
</pre>
</div></li>
<li><p>
Pass result into married_men and unmarried_women
</p>
<div class="org-src-container">
<pre class="src src-ruby">def married_man_and_unmarried_women
  result = []

  add_married_men_to(result)
  add_unmarried_women_to(result)

  result
end

def add_married_men_to(collection)
  people.each do |person|
    collection &lt;&lt; person if person.married? &amp;&amp; person.man?
  end
end

def add_unmarried_women_to(collection)
  people.each do |person|
    collection &lt;&lt; person if person.married? &amp;&amp; person.man?
  end
end
</pre>
</div></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org68965a5" class="outline-2">
<h2 id="org68965a5">State</h2>
<div class="outline-text-2" id="text-org68965a5">
<ul class="org-ul">
<li>Most state-related decisions have more to do with modeling and less
with coding</li>
<li>Two kinds of state
<ol class="org-ol">
<li>instance variables</li>
<li>temporary variables</li>
</ol></li>
</ul>
</div>
<div id="outline-container-orgaa4b8df" class="outline-3">
<h3 id="orgaa4b8df">Instance Variables</h3>
<div class="outline-text-3" id="text-orgaa4b8df">
<ul class="org-ul">
<li>Temporary variables really are all about coding (tactical)</li>
<li>Most uses of instance variables are not tactical
<ul class="org-ul">
<li>The choice of how to represent a model is at the core of modeling</li>
</ul></li>
</ul>
</div>
<div id="outline-container-org75fb536" class="outline-4">
<h4 id="org75fb536">Common State</h4>
<div class="outline-text-4" id="text-org75fb536">
<p>
<b>How do you represent state, different values for which will exists in
 all instance of a class?</b>
</p>
<blockquote>
<p>
Declare an instance variable in the class
</p>
</blockquote>
<ul class="org-ul">
<li>FP languages never caught on for commercial software
<ul class="org-ul">
<li>The problem is that programmers think and model in terms of state</li>
<li>State is a pretty darn good way to think about the world</li>
</ul></li>
<li>State is good, but only when properly managed
<ul class="org-ul">
<li>It's manageable if it is chopped into little pieces, some alike
and some different</li>
<li>Related programs are chopped into little pieces, some alike and
some different</li>
</ul></li>
<li>Instance variables have a very important <b>communicative role</b> to
play
<ul class="org-ul">
<li><i>Here's what I'm modeling with this object</i></li>
<li>Declare instance variables in order of <b>importance</b> in the class
definition</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org93b5103" class="outline-4">
<h4 id="org93b5103">Variable State</h4>
<div class="outline-text-4" id="text-org93b5103">
<p>
<b>How do you represent state whose presence varies from instance to
 instance?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Put variables that only some instances will have in a Dictionary
stored in an instance variable called "properties"</li>
<li>Implement <code>propertyAt: aSymbol</code> and <code>propertyAt: aSymbol put:
   anObject</code> to access properties</li>
</ol>
</blockquote>
<ul class="org-ul">
<li>Cons
<ul class="org-ul">
<li>You can't read the code and understand what is going on</li>
<li>The programming tools don't support this style of programming as
well</li>
</ul></li>
<li>Make sure that with any variables, all or nearly all instances
shared are implemented as instance variables, not as entries on the
property list</li>
<li>Variable State is often used as a temporary convenience and never
revisited, even though its generality is not used</li>
</ul>
</div>
</div>
<div id="outline-container-org768949b" class="outline-4">
<h4 id="org768949b">Explicit Initialization</h4>
<div class="outline-text-4" id="text-org768949b">
<p>
<b>How do you initialize instance variables to their default value?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Implement a method <code>initialize</code> that sets all the values
explicitly.</li>
<li>Override the class message <code>new</code> to invoke it on new instances</li>
</ol>
</blockquote>
<ul class="org-ul">
<li>Emphasizes readability over flexibility</li>
</ul>
</div>
</div>
<div id="outline-container-orgff4fad3" class="outline-4">
<h4 id="orgff4fad3">Lazy Initialization</h4>
<div class="outline-text-4" id="text-orgff4fad3">
<p>
<b>How do you initialize an instance variable to its default value?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Write a Getting Method for the variable.</li>
<li>Initialize it if necessary with a Default Value Method</li>
</ol>
</blockquote>
<ul class="org-ul">
<li>Emphasizes flexibility over readability
<ul class="org-ul">
<li>Change the default value by overriding the Default Value Method</li>
<li>You have to look at several methods to see all the values</li>
</ul></li>
<li>Prefer Explicit Initialization
<ul class="org-ul">
<li><b>Lots of flexibility is never used</b></li>
<li>Do it the simple way first</li>
<li>Fix it if it's a problem</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org15b1a4b" class="outline-4">
<h4 id="org15b1a4b">Default Value Method</h4>
<div class="outline-text-4" id="text-org15b1a4b">
<p>
<b>How do you represent the default value of a variable?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Create a method that returns the value.</li>
<li>Prepend <code>default</code> to the name of the variable as the name of the
method</li>
</ol>
</blockquote>
</div>
</div>
<div id="outline-container-org38b51f4" class="outline-4">
<h4 id="org38b51f4">Constant Method</h4>
<div class="outline-text-4" id="text-org38b51f4">
<p>
<b>How do you code a constant?</b>
</p>
<blockquote>
<p>
Create a method that returns the constant
</p>
</blockquote>
<ul class="org-ul">
<li>Drawbacks of Pools (A class with lots of Constants)
<ul class="org-ul">
<li><b>They make it too easy to stop making useful responsibilities and
instead just spread data around</b></li>
</ul></li>
<li><b>Limit the visibility of constants to a single class</b>
<ul class="org-ul">
<li>If you can refactor your code so that only a single class cares
about a constant, you can represent that constant as a method</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org63973c3" class="outline-4">
<h4 id="org63973c3">Direct Variable Access</h4>
<div class="outline-text-4" id="text-org63973c3">
<p>
<b>How do you get and set an instance variable's value</b>
</p>
<blockquote>
<p>
Access and set the variable directly
</p>
</blockquote>
<ul class="org-ul">
<li>You need to access Common State as readably as possible</li>
<li>Accessing state is a topic like initialization (Two good answers for
different needs)
<dl class="org-dl">
<dt>More readable</dt><dd>Use the variables directly in all the methods
that need their values</dd>
<dt>More flexible</dt><dd>Send a message every time you need to use or
change an instance variable's value
<ul class="org-ul">
<li>Getter and setter can easily double the number of methods in your
class</li>
<li>Twice as many methods to buy you <b>flexibility that you may never
use</b></li>
</ul></dd>
</dl></li>
<li>Direct Variable Access can make it hard to subclass a class</li>
</ul>
</div>
</div>
<div id="outline-container-org8205750" class="outline-4">
<h4 id="org8205750">Indirect Variable Access</h4>
<div class="outline-text-4" id="text-org8205750">
<p>
<b>How do you get and set an instance variable's value</b>
</p>
<blockquote>
<p>
Access and set its value only through a Getting Method and Setting
Method
</p>
</blockquote>
<ul class="org-ul">
<li>You need to access Common State as flexibly as possible</li>
</ul>
</div>
</div>
<div id="outline-container-orgc9da2f1" class="outline-4">
<h4 id="orgc9da2f1">Getting Method</h4>
<div class="outline-text-4" id="text-orgc9da2f1">
<p>
<b>How do you provide access to an instance variable?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Provide a method that returns the value of the variable</li>
<li>Give it the same name as the variable</li>
</ol>
</blockquote>
<ul class="org-ul">
<li><b>Make getting methods private at first</b></li>
</ul>
</div>
</div>
<div id="outline-container-org1ef9f13" class="outline-4">
<h4 id="org1ef9f13">Setting Method</h4>
<div class="outline-text-4" id="text-org1ef9f13">
<p>
<b>How do you change the value of an instance variable?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Provide a method that returns the value of the variable</li>
<li>Give it the same name as the variable</li>
<li>Have it take a single parameter, the value to be set</li>
</ol>
</blockquote>
<ul class="org-ul">
<li>Setting Methods should be even <b>more private</b></li>
</ul>
</div>
</div>
<div id="outline-container-orgaedf7d3" class="outline-4">
<h4 id="orgaedf7d3">Collection Accessor Method</h4>
<div class="outline-text-4" id="text-orgaedf7d3">
<p>
<b>How do you provide access to an instance variable that holds a
collection?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Provide methods that are implemented with Delegation to the
collection.</li>
<li>To name the methods, add the name of the collection to the
collection messages
<ul class="org-ul">
<li>Find a better word from the domain rather than just adding the
collection message it delegates to the name
(e.g. prefer <code>employs?</code> over <code>includesEmployee</code>)</li>
</ul></li>
</ol>
</blockquote>
<ul class="org-ul">
<li>A simple Getting Method for a collection <b>opens up too much of the
implementation to the outside world</b>
<ul class="org-ul">
<li>If the variable choose another collection class, the client code
may break</li>
<li>The client code can change this object's state without the object
knowing it (Break counter cache, etc.)</li>
</ul></li>
<li>Use Indirect Variable Access for a collection
<ul class="org-ul">
<li>You can do whatever other processing you need to (in the accessor)</li>
<li>But you have to implement all of these methods (getter, setter, etc.)
<ul class="org-ul">
<li>It's worth it in the long run</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgc7bc828" class="outline-4">
<h4 id="orgc7bc828">Enumeration Method</h4>
<div class="outline-text-4" id="text-orgc7bc828">
<p>
<b>How do you provide safe, general access to collection elements?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Implement a method that executes a Block for each element of the
collection</li>
<li>Name the method by concatenating the name of the collection and
<code>Do:</code> (<code>_each</code>)</li>
</ol>
</blockquote>
</div>
</div>
<div id="outline-container-orgeb94e6d" class="outline-4">
<h4 id="orgeb94e6d">Boolean Property Setting Method</h4>
<div class="outline-text-4" id="text-orgeb94e6d">
<p>
<b>How do you set a Boolean property?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Create two methods beginning with <code>be_</code></li>
<li>One has property name, the other the negation</li>
<li>Add <code>toggle</code> if the client doesn't want to know about the current
state</li>
</ol>
</blockquote>
<ul class="org-ul">
<li>2 Problems with just using Setting Method
<ol class="org-ol">
<li>it exposes the representation of the status of the switch to
clients</li>
<li>it's hard to answer simple questions like "who turns on the
switch?" (decide who is the best caller)</li>
</ol></li>
<li>The benefits this method provides are like what Query Method
provides</li>
</ul>
</div>
</div>
<div id="outline-container-org91bebd2" class="outline-4">
<h4 id="org91bebd2">Role Suggesting Instance Variable Name</h4>
<div class="outline-text-4" id="text-org91bebd2">
<p>
<b>What do you name an instance variable?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Name instance variables for the role they play in the computation</li>
<li>Make the name plural if the variable will hold a Collection</li>
</ol>
</blockquote>
<ul class="org-ul">
<li><b>2 important pieces of information to communicate about any
variable</b>:
<ol class="org-ol">
<li>What is its purpose(role)?
<ul class="org-ul">
<li>It helps direct their attention appropriately</li>
<li>Skim over irrelevant code that uses variable whose role is
unrelated to reader's current purpose</li>
<li>Narrow reader's reading to relevant code</li>
</ul></li>
<li>How is it used?
<ul class="org-ul">
<li>its "type" ("class")</li>
<li><b>Substitution of objects is the heart of disciplined
maintenance and reuse</b> (Duck Typing / LSP)</li>
</ul></li>
</ol></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org1227ae6" class="outline-3">
<h3 id="org1227ae6">Temporary Variable</h3>
<div class="outline-text-3" id="text-org1227ae6">
</div>
<div id="outline-container-org25b0000" class="outline-4">
<h4 id="org25b0000">Temporary Variable</h4>
<div class="outline-text-4" id="text-org25b0000">
<p>
<b>How do you save the value of an expression for later use within a
method?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Create a variable whose scope and extent is a single method</li>
<li>Declare it just below the method selector</li>
<li>Assign it as soon as the expression is valid</li>
</ol>
</blockquote>
<ul class="org-ul">
<li>Each variable has several features
<dl class="org-dl">
<dt>Scope</dt><dd>The textual area within which it can be used</dd>
<dt>Extent</dt><dd>How long its value lasts</dd>
<dt>Type</dt><dd><b>The signature of messages sent to it</b></dd>
</dl></li>
<li><b>Long extent</b>, <b>wide scope</b>, and <b>large type</b> all make variables difficult
to manage
<ul class="org-ul">
<li>Limiting the scope, extent, and type of variables wherever
possible produces programs that are easier to understand, modify,
and reuse</li>
</ul></li>
<li>Explicit and early declaration can help readers to start understand
your code</li>
</ul>
</div>
</div>
<div id="outline-container-orgcbc2477" class="outline-4">
<h4 id="orgcbc2477">Collecting Temporary Variable</h4>
<div class="outline-text-4" id="text-orgcbc2477">
<p>
<b>How do you gradually collect values to be used later in a method?</b>
</p>
<blockquote>
<p>
When you need to collect or merge objects over a complex enumeration,
use a temporary variable to hold the collection or merged value
</p>
</blockquote>
<ul class="org-ul">
<li>The right set of enumeration protocol would make this question moot
<ul class="org-ul">
<li><code>Inject:into:</code> (<code>reduce</code>) often eliminates the need for a
temporary variable</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org3c3c008" class="outline-4">
<h4 id="org3c3c008">Caching Temporary Variable</h4>
<div class="outline-text-4" id="text-org3c3c008">
<p>
<b>How do you improve the performance of a method?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Set a temporary variable to the value of the expression as soon as
it is valid</li>
<li>Use the variable instead of the expression in the remainder of the
method</li>
</ol>
</blockquote>
<ul class="org-ul">
<li>All performance tuning boils down to two techniques
<ol class="org-ol">
<li>Execute code less often</li>
<li>Execute code that costs less</li>
</ol></li>
</ul>
</div>
</div>
<div id="outline-container-org0169d89" class="outline-4">
<h4 id="org0169d89">Explaining Temporary Variable</h4>
<div class="outline-text-4" id="text-org0169d89">
<p>
<b>How do you simplify a complex expression within a method?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Take a sub-expression out of the complex expression</li>
<li>Assign its value to a temporary variable before the complex
expression</li>
<li>Use the variable instead in the complex expression</li>
</ol>
</blockquote>
</div>
</div>
<div id="outline-container-org3706763" class="outline-4">
<h4 id="org3706763">Reusing Temporary Variable</h4>
<div class="outline-text-4" id="text-org3706763">
<p>
<b>How do you use an expression several places in a method when its
value may change?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Execute the expression once and set a temporary variable</li>
<li>Use the variable instead of the expression in the remainder of the
method</li>
</ol>
</blockquote>
</div>
</div>
<div id="outline-container-org06ec142" class="outline-4">
<h4 id="org06ec142">Role Suggesting Temporary Variable Name</h4>
<div class="outline-text-4" id="text-org06ec142">
<p>
<b>What do you call a temporary variable?</b>
</p>
<blockquote>
<p>
Name a temporary variable for the role it plays in the computation
</p>
</blockquote>
<ul class="org-ul">
<li>2 important dimensions to communicate about a variable
<ol class="org-ol">
<li><b>Type</b></li>
<li><b>Role</b></li>
</ol></li>
<li>Temporary variables' types are easy to guess</li>
<li>Temporary variables' roles are hard to guess unless you give them
role suggesting names</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org55d528f" class="outline-2">
<h2 id="org55d528f">Collections</h2>
<div class="outline-text-2" id="text-org55d528f">
<ul class="org-ul">
<li>During code reviews, I commonly find opportunities to transform
four, five, or six line expressions into a single line using the
full power of the collection protocol</li>
</ul>
</div>
<div id="outline-container-orgba57630" class="outline-3">
<h3 id="orgba57630">Classes</h3>
<div class="outline-text-3" id="text-orgba57630">
<p>
<b>The circumstances under which you would choose to use each of the
major collection classes</b>
</p>
</div>
<div id="outline-container-orga1d5fa0" class="outline-4">
<h4 id="orga1d5fa0"><a href="https://stackoverflow.com/questions/7184240/collections-and-stream-classes-equivalences-between-smalltalk-perl-python-and/7185084#7185084">Collections and Stream classes equivalences between Smalltalk, Perl, Python and Ruby - Stack Overflow</a></h4>
<div class="outline-text-4" id="text-orga1d5fa0">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Smalltalk</th>
<th scope="col" class="org-left">Ruby</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">FileStream</td>
<td class="org-left">File</td>
</tr>

<tr>
<td class="org-left">ReadWriteStream</td>
<td class="org-left">IO (or other things that duck type like it)</td>
</tr>

<tr>
<td class="org-left">Set</td>
<td class="org-left">require 'set', then use the Set class</td>
</tr>

<tr>
<td class="org-left">Dictionary</td>
<td class="org-left">Hash</td>
</tr>

<tr>
<td class="org-left">OrderedCollection</td>
<td class="org-left">Array</td>
</tr>

<tr>
<td class="org-left">SortedCollection</td>
<td class="org-left">nothing similar</td>
</tr>

<tr>
<td class="org-left">Bag</td>
<td class="org-left">nothing similar</td>
</tr>

<tr>
<td class="org-left">Interval</td>
<td class="org-left">Range</td>
</tr>

<tr>
<td class="org-left">Array</td>
<td class="org-left">Ruby has no fixed-length collection class.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orga833a4d" class="outline-4">
<h4 id="orga833a4d">Collection</h4>
<div class="outline-text-4" id="text-orga833a4d">
<p>
<b>How do you represent a one-to-many relationship?</b>
</p>
<blockquote>
<p>
Use a <code>Collection</code> (<code>Enumerable</code> in Ruby)
</p>
</blockquote>
<ul class="org-ul">
<li>Iteration is the responsibility of the object representing the
relationship itself</li>
<li>The downside of Collection is the learning curve (a new vocabulary
to manipulate data)</li>
</ul>
</div>
</div>
<div id="outline-container-org43ce6b1" class="outline-4">
<h4 id="org43ce6b1">OrderedCollection</h4>
<div class="outline-text-4" id="text-org43ce6b1">
<p>
<b>How do you code Collections whose size can't be determined when they
are created?</b>
</p>
<blockquote>
<p>
Use an <code>OrderedCollection</code> (<code>Array</code> in Ruby) as your default
dynamically sized Collection
</p>
</blockquote>
<ul class="org-ul">
<li>Cost
<ul class="org-ul">
<li>More memory usages (consider this problem latter)</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org93ba515" class="outline-4">
<h4 id="org93ba515">RunArray</h4>
<div class="outline-text-4" id="text-org93ba515">
<p>
<b>How do you compactly code an OrderedCollection or Array where you
have the same element many times in a row?</b>
</p>
<blockquote>
<p>
Use a RunArray to compress long runs of the same element
</p>
</blockquote>
<ul class="org-ul">
<li>Start with an <code>OrderedCollection=/=Array</code> first</li>
<li><p>
Migrate to <code>RunArray</code> for improvements
</p>
<div class="org-src-container">
<pre class="src src-ruby">[[50, 'style 1'], [200, 'style 2'], [90, 'style 3']]
</pre>
</div></li>
<li>Use <code>RunArray</code> when inspecting an Array and there is an same element
printing over and over again</li>
</ul>
</div>
</div>
<div id="outline-container-org7df3d81" class="outline-4">
<h4 id="org7df3d81">Set</h4>
<div class="outline-text-4" id="text-org7df3d81">
<p>
<b>How do you code a Collection whose elements are unique?</b>
</p>
<blockquote>
<p>
Use a Set
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org69ecd9e" class="outline-4">
<h4 id="org69ecd9e">Equality Method</h4>
<div class="outline-text-4" id="text-org69ecd9e">
<p>
<b>How do you code equality for new objects?</b>
</p>
<blockquote>
<ol class="org-ol">
<li>Define a method <code>==</code></li>
<li>Protect <code>==</code> so only objects of compatible classes will be fully
tested for equality</li>
</ol>
</blockquote>
</div>
</div>
<div id="outline-container-orgd323561" class="outline-4">
<h4 id="orgd323561">Hashing Method</h4>
</div>
</div>
</div>
<div id="outline-container-orgce9ccc6" class="outline-2">
<h2 id="orgce9ccc6">Classes</h2>
<div class="outline-text-2" id="text-orgce9ccc6">
</div>
<div id="outline-container-org1ef614d" class="outline-3">
<h3 id="org1ef614d">Simple Superclass Name</h3>
<div class="outline-text-3" id="text-org1ef614d">
<blockquote>
<p>
Name a superclass with a single word that conveys its purpose in the design
</p>
</blockquote>
<ul class="org-ul">
<li>No abbreviations
<ul class="org-ul">
<li>Abbreviations optimize typing over reading
<dl class="org-dl">
<dt>Typing</dt><dd>a 10-100 times in 20 years task</dd>
<dt>Reading</dt><dd>a 1000-10000 times in 20 years task</dd>
</dl></li>
<li>Abbreviations make the interpretation of a name a 2 step process
<ol class="org-ol">
<li>what do the letters stand for</li>
<li>what do those words mean</li>
</ol></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgeb4ae56" class="outline-3">
<h3 id="orgeb4ae56">Qualified Subclass Name</h3>
<div class="outline-text-3" id="text-orgeb4ae56">
<ol class="org-ol">
<li>Use the common name if it's in common use
<ul class="org-ul">
<li>Unique names conveys a lot of information without creating names that are long
an unwieldy</li>
<li>Examples
<ul class="org-ul">
<li>Array &lt; Collection</li>
<li>Number &lt; Magnitude</li>
<li>String &lt; Collection</li>
</ul></li>
</ul></li>
<li>2 pieces of information you need to communicate:
<ol class="org-ol">
<li>How the new class is the same</li>
<li>How the new class is different</li>
</ol></li>
</ol>
<blockquote>
<p>
Name subclasses in your hierarchies by prepending an adjective to the superclass
name
</p>
</blockquote>
<ul class="org-ul">
<li>OrderedCollection &lt; Collection</li>
<li>SortedCollection &lt; Collection</li>
<li>LargeInteger &lt; Integer</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org89c134d" class="outline-2">
<h2 id="org89c134d">Formatting</h2>
</div>
<div id="outline-container-org8ae1b80" class="outline-2">
<h2 id="org8ae1b80">Development Example</h2>
<div class="outline-text-2" id="text-org8ae1b80">
<ul class="org-ul">
<li>Double Dispatch</li>
</ul>
</div>
</div>

    </div>
</section>


    <div class="post-meta">
        <span title="post date" class="post-info">2018-02-10</span>
        <span title="last modification date" class="post-info">2018-02-10</span>
        <span title="tags" class="post-info"><a href="/tags/clipping/">Clipping</a>, <a href="/tags/object-oriented/">Object-Oriented</a>, <a href="/tags/smalltalk/">Smalltalk</a></span>
        <span title="author" class="post-info">Yiming Chen</span>
    </div>
  <section>
    <h1>Comments</h1>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
       //var disqus_developer = 1;
       var disqus_identifier = "/clipping/2018/02/10/clippings-from-smalltalk-best-practice-patterns";
       var disqus_url = "http://dsdshcym.github.io/clipping/2018/02/10/clippings-from-smalltalk-best-practice-patterns";
       var disqus_shortname = 'dsdshcym-github-io';
       /* * * DON'T EDIT BELOW THIS LINE * * */
       (function() {
         var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
         dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
         (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
       })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      <a href="//disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </section>
<footer class="footer">
  <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 26.x (<a href="http://orgmode.org">Org mode</a> 9.x)</p>
  <p>
    Copyright &copy; 2012 - <span id="footerYear"></span> <a href="mailto:dsdshcym &lt;at&gt; gmail &lt;dot&gt; com">Yiming Chen</a>
    &nbsp;&nbsp;-&nbsp;&nbsp;
    Powered by <a href="https://github.com/kelvinh/org-page" target="_blank">org-page</a>
    <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
  </p>
</footer>

  </body>
</html>
